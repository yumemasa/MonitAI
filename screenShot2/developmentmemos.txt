1. ログや分析結果の保存場所と蓄積について
保存場所:
現状、ログや分析結果はファイルには保存されていません。
すべてアプリケーションの画面上（メモリ内）にのみ表示されており、アプリを終了するとすべて消えます。
蓄積について:
システムログ（左側のログ）: AddLog メソッド内で文字数制限が行われており、5000文字を超えると古いログから自動的に削除されます。そのため無限には蓄積されません。
分析結果（右側の表示エリア）: こちらには削除ロジックが入っていません。そのため、アプリを起動し続けている間は無限に追記され続けます（メモリが許す限り）。
2. Gemini CLIへの画像送信と表示の仕組み
送信の仕組み:
AnalyzeWithGeminiCliAsync メソッド内で、Gemini CLIコマンド（gemini.cmd）を実行しています。
この際、コマンドライン引数として「プロンプト（指示書）」と「画像のファイルパス」を渡しています。
具体的には、--allowed-tools read_file オプションを付けて、CLIがローカルの画像を読み取れるようにしています。
表示の仕組み:
CLIが実行されると、分析結果が「標準出力（テキスト）」として返ってきます。
アプリはこれを受け取り、先ほど修正した CleanCliOutput メソッドで不要な行（起動ログなど）を削除します。
整形されたテキストを HandleGeminiResult メソッドが受け取り、画面右側のテキストボックス（ResultTextBox）に AppendText で追記しています。
3. Gemini CLIのスレッド（チャット）管理
現状の設計:
「質問ごとに新しいスレッド（チャット）が立ち上がる」 形式です。
理由:
コード内の RunCommandAsync メソッドでは、分析のたびに Process.Start を使って新しく gemini コマンドを起動し、終了を待っています。

*   前回の会話の内容（コンテキスト）は記憶されず、毎回「初対面」として分析が行われます。*   ただし、ユーザーが設定した「ルール」は毎回プロンプトに含めて送信しているため、指示内容は維持されます。
Gemini 3 Pro (Preview) • 1x